<!-- ====================================================================== 
     XMLExamples    
     Script to run xml examples
     ====================================================================== -->
<project name="XMLExamples" default="compile">
    <description>
            Script to compile xml examples
    </description>
	<property name="xmlsamplesdir" value="xml"/>

	<!-- ================================= 
          target: schemagen              
         ================================= -->
    <target name="schemagen" description="--> generate schema from hand-annotated classes">
    	<echo message="Generating the schema..." />
    	<mkdir dir="gen-schema" />
    	<exec executable="schemagen">
    	    	    <arg line="-d gen-schema -cp src src/it/polito/dp2/xml/library/annotated/Books.java src/it/polito/dp2/xml/library/annotated/package-info.java"/>
    	</exec>
    	<!-- Delete class files generated by schemagen -->
    	<delete dir="gen-schema/it"/>
    	<!-- Change the schema file name (schemagen generates a schema file called schema1.xsd) -->
    	<move file="gen-schema/schema1.xsd" tofile="gen-schema/books.xsd" />
    </target>


	<!-- ================================= 
          target: compile              
         ================================= -->
    <target name="compile" depends="schemagen" description="--> compile examples">
    	<echo message="Compiling the source schema..." />
    	<mkdir dir="gen-src" />
    	<exec executable="xjc">
    	    <arg line="-d gen-src -p it.polito.dp2.xml.library.gen ${xmlsamplesdir}/books.xsd"/>
    	</exec>
    	<echo message="Compiling the java source files..." />
    	<mkdir dir="bin" />
    	<javac destdir="bin" debug="on">
    	   <src path="gen-src" />
    	   <src path="src" />
    	</javac>
    	<!-- copy jaxb.index with class files -->
    	<copy tofile="bin/it/polito/dp2/xml/library/annotated/jaxb.index" 
    		  file="src/it/polito/dp2/xml/library/annotated/jaxb.index"/>
    </target>

	<!-- ================================= 
          target: clean              
         ================================= -->
    <target name="clean" description="--> clean">
    	<echo>Cleaning</echo>
    	<delete dir="gen-src"/>
    	<delete dir="gen-schema"/>
    	<delete dir="bin"/>
    </target>

</project>